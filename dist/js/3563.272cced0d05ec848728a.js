"use strict";(self.webpackChunkreact_webpack=self.webpackChunkreact_webpack||[]).push([[3563],{58975:(e,t,n)=>{n.d(t,{Z:()=>y});var i=n(63497),r=n.n(i),o=n(9830),l=n.n(o),a=n(30695),c=n.n(a),s=n(83507),u=n.n(s),d=n(69024),p=n.n(d),f=n(600),v=n.n(f),m=n(85893),h=n(67294);var y=function(e){u()(o,e);var t,n,i=(t=o,n=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(r()(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=v()(t);if(n){var o=v()(this).constructor;e=r()(i,arguments,o)}else e=i.apply(this,arguments);return p()(this,e)});function o(){return l()(this,o),i.apply(this,arguments)}return c()(o,[{key:"render",value:function(){var e=this.props,t=e.visible,n=e.children,i=t?n:null;return(0,m.jsx)(h.Fragment,{children:i})}}]),o}(h.PureComponent)},29713:(e,t,n)=>{n.d(t,{Z:()=>I});var i=n(58548),r=n.n(i),o=n(78829),l=n.n(o),a=n(51765),c=n.n(a),s=n(93287),u=n.n(s),d=n(24309),p=n.n(d),f=n(33929),v=n.n(f),m=n(63497),h=n.n(m),y=n(69984),b=n.n(y),x=n(11845),g=n.n(x),_=n(9830),T=n.n(_),j=n(30695),S=n.n(j),w=n(83507),Z=n.n(w),k=n(69024),C=n.n(k),D=n(600),A=n.n(D),N=n(85893),R=n(67294),M=n(31097),V=n(80411),P=n.n(V);function F(e,t){var n=v()(e);if(p()){var i=p()(e);t&&(i=i.filter((function(t){return u()(e,t).enumerable}))),n.push.apply(n,i)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){b()(e,t,n[t])})):c()?l()(e,c()(n)):F(Object(n)).forEach((function(t){r()(e,t,u()(n,t))}))}return e}var I=function(e){Z()(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(h()(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=A()(t);if(n){var r=A()(this).constructor;e=h()(i,arguments,r)}else e=i.apply(this,arguments);return C()(this,e)});function r(){return T()(this,r),i.apply(this,arguments)}return S()(r,[{key:"render",value:function(){var e=this.props,t=(e.content,e.minHgWid),n=void 0===t?20:t,i=e.children,r=e.bgOpacity,o=void 0!==r&&r,l=g()(e,["content","minHgWid","children","bgOpacity"]),a=(0,N.jsx)("div",{className:"hover-tips-content",children:i});return(0,N.jsx)(M.Z,L(L({title:a,className:"hover-tips-popover"},l),{},{children:(0,N.jsx)("div",{id:"hover-tips",className:P()({"bg-opacity":o}),style:{minHeight:n,minWidth:n}})}))}}]),r}(R.Component)},10438:(e,t,n)=>{n.d(t,{p$:()=>s,qW:()=>u,xb:()=>d}),n(74720);var i=n(33929),r=n.n(i),o=n(24422),l=n.n(o),a=(n(94504),n(94100),n(94513)),c=n.n(a);function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(e,t){return e.filter(t)[0]}if(null===e||"object"!==c()(e))return e;var i=n(t,(function(t){return t.original===e}));if(i)return i.copy;var o=l()(e)?[]:{};return t.push({original:e,copy:o}),r()(e).forEach((function(n){o[n]=s(e[n],t)})),o}n(89060),n(93133),n(49204);var u=function(e,t){return function(n){if(""===n||null==n)return"";var i=e.find((function(e){return e.value==n}));return i?i.label:t||n}};function d(e){return null==e}},93563:(e,t,n)=>{n.r(t),n.d(t,{default:()=>X});var i=n(58548),r=n.n(i),o=n(78829),l=n.n(o),a=n(51765),c=n.n(a),s=n(93287),u=n.n(s),d=n(24309),p=n.n(d),f=n(33929),v=n.n(f),m=n(63497),h=n.n(m),y=n(48550),b=n.n(y),x=n(69984),g=n.n(x),_=n(10490),T=n.n(_),j=n(27802),S=n.n(j),w=n(74720),Z=n.n(w),k=n(9830),C=n.n(k),D=n(30695),A=n.n(D),N=n(83507),R=n.n(N),M=n(69024),V=n.n(M),P=n(600),F=n.n(P),L=n(85893),I=n(67294),E=n(10438),G=n(58975),B=n(34041),O=n(48086),H=n(32478),Y=n(71577),W=n(14617),$=n(49101),z=n(29713),J=n(7791),q=n(17803);function K(e,t){var n=v()(e);if(p()){var i=p()(e);t&&(i=i.filter((function(t){return u()(e,t).enumerable}))),n.push.apply(n,i)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?K(Object(n),!0).forEach((function(t){g()(e,t,n[t])})):c()?l()(e,c()(n)):K(Object(n)).forEach((function(t){r()(e,t,u()(n,t))}))}return e}var U=B.Z.Option;const X=function(e){R()(r,e);var t,n,i=(t=r,n=function(){if("undefined"==typeof Reflect||!h())return!1;if(h().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(h()(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=F()(t);if(n){var r=F()(this).constructor;e=h()(i,arguments,r)}else e=i.apply(this,arguments);return V()(this,e)});function r(e){var t;C()(this,r),(t=i.call(this,e)).inputRef=(0,I.createRef)(),t.formRef=I.createRef(),t.editMemberRef=I.createRef(),t.editDepartRef=I.createRef(),t.invoiceTitleSelectorRef=I.createRef(),t.feeTypeSelectorRef=I.createRef(),t.travelTypeRef=I.createRef(),t.travelModeRef=I.createRef(),t.submit=function(){var e=t.formRef.current.getFieldsValue().conditions,n=[J.Fr,J.l9,J.lt,J.Al,J.w7,J.NY,J.l2,J.Bv];if(console.log(e),e&&0!=e.length){for(var i=!0,r=0;r<e.length;r++){if(!e[r]){i=!1,O.ZP.warn("请选择条件");break}if(e[r].conditionType==J.l9&&(e[r].members=(e[r].members||[]).filter((function(e){return!e.leave}))),e[r].conditionType==J.l9&&(!e[r].members||0==e[r].members.length)){i=!1,O.ZP.warn("请选择申请人");break}if(!(e[r].conditionType!=J.Fr||e[r].departs&&0!=e[r].departs.length)){i=!1,O.ZP.warn("请选择费用部门");break}if(!(e[r].conditionType!=J.lt||e[r].feeData&&0!=e[r].feeData.length)){i=!1,O.ZP.warn("请选择费用类型");break}if(!(e[r].conditionType!=J.Bv||e[r].roles&&0!=e[r].roles.length)){i=!1,O.ZP.warn("请选择角色");break}if(e[r].conditionType==J.Bv&&e[r].roles.some((function(e){return e.is_del}))){i=!1,O.ZP.warn("有已删除角色配置，请作更改");break}if(!(e[r].conditionType!=J.Al||e[r].titles&&0!=e[r].titles.length)){i=!1,O.ZP.warn("请选择公司抬头");break}if(!(e[r].conditionType!=J.w7||e[r].travelModeData&&0!=e[r].travelModeData.length)){i=!1,O.ZP.warn("请选择出行方式");break}if(!(e[r].conditionType!=J.NY||e[r].travelTypeData&&0!=e[r].travelTypeData.length)){i=!1,O.ZP.warn("请选择出行类型");break}if(!(e[r].conditionType!=J.l2||e[r].officeLocationData&&0!=e[r].officeLocationData.length)){i=!1,O.ZP.warn("请选择办公地点");break}if(e[r].conditionType==J.j4){if(!e[r].startAmount||e[r].relation==J.xG&&!e[r].endAmount){i=!1,O.ZP.warn("请输入出差时长");break}if(e[r].relation==J.xG&&(e[r].startAmount<=0||e[r].endAmount<=0)){i=!1,O.ZP.warn("请输入大于0整数");break}if(e[r].relation!=J.xG&&e[r].startAmount<=0){i=!1,O.ZP.warn("请输入大于0整数");break}var o=/^[0-9]+$/;if(!(e[r].relation!=J.xG||o.test(e[r].startAmount)&&o.test(e[r].endAmount))){i=!1,O.ZP.warn("请输入大于0整数");break}if(e[r].relation!=J.xG&&!o.test(e[r].startAmount)){i=!1,O.ZP.warn("请输入大于0整数");break}if(e[r].relation==J.xG&&(e[r].startAmount.toString().length>15||e[r].endAmount.length>15)){i=!1,O.ZP.warn("时长输入长度不能大于15位");break}if(e[r].relation!=J.xG&&e[r].startAmount.toString().length>15){i=!1,O.ZP.warn("时长输入长度不能大于15位");break}}else if(!n.includes(e[r].conditionType)){if(!e[r].startAmount||e[r].relation==J.xG&&!e[r].endAmount){i=!1,O.ZP.warn("请输入金额");break}if(e[r].relation==J.xG&&(e[r].startAmount<=0||e[r].endAmount<=0)){i=!1,O.ZP.warn("请输入大于0的金额");break}if(e[r].relation!=J.xG&&e[r].startAmount<=0){i=!1,O.ZP.warn("请输入大于0的金额");break}var l=/(^[1-9](\d+)?(\.\d{1,2})?$)|(^0$)|(^\d\.\d{1,2}$)/;if(!(e[r].relation!=J.xG||l.test(e[r].startAmount)&&l.test(e[r].endAmount))){i=!1,O.ZP.warn("请输入正确的金额");break}if(e[r].relation!=J.xG&&!l.test(e[r].startAmount)){i=!1,O.ZP.warn("请输入正确的金额");break}if(e[r].relation==J.xG&&(e[r].startAmount.toString().length>15||e[r].endAmount.length>15)){i=!1,O.ZP.warn("金额输入长度不能大于15位");break}if(e[r].relation!=J.xG&&e[r].startAmount.toString().length>15){i=!1,O.ZP.warn("金额输入长度不能大于15位");break}}}if(i){var a={conditions:e.map((function(e){return function(e){if(e.conditionType===J.l9){var t=e.members.filter((function(e){return!e.leave})).map((function(e){return"".concat(e.id,"#").concat(e.name)}));return{type:e.conditionType,compare:e.relation,value:t.join(",")}}if(e.conditionType===J.Fr){var n=e.departs.map((function(e){return"".concat(e.id,"#").concat(e.name)}));return{type:e.conditionType,compare:e.relation,value:n.join(",")}}if(e.conditionType===J.Al){var i=e.titles.map((function(e){return"".concat(e.enterprise_title_id,"#").concat(e.enterprise_name)}));return{type:e.conditionType,compare:e.relation,value:i.join(",")}}if(e.conditionType===J.lt){var r=e.feeData.map((function(e){return"".concat(e.fee_type,"#").concat(e.fee_name)}));return{type:e.conditionType,compare:e.relation,value:r.join(",")}}if(e.conditionType===J.w7){var o=e.travelModeData.map((function(e){return"".concat(e.value)}));return{type:e.conditionType,compare:e.relation,value:o.join(",")}}if(e.conditionType===J.NY){var l=e.travelTypeData.map((function(e){return"".concat(e.value)}));return{type:e.conditionType,compare:e.relation,value:l.join(",")}}if(e.conditionType===J.l2){var a=e.officeLocationData;return{type:e.conditionType,compare:e.relation,value:a.join(",")}}if(e.conditionType===J.j4){var c=e.relation==J.xG?"".concat(+e.startAmount,",").concat(+e.endAmount):"".concat(+e.startAmount);return{type:e.conditionType,compare:e.relation,value:c}}if(e.conditionType===J.Bv){var s=e.roles.map((function(e){return"".concat(e.role_id,"#").concat(e.role_name)}));return{type:e.conditionType,compare:e.relation,value:s.join(",")}}var u=e.relation==J.xG?"".concat((+e.startAmount).mul(100),",").concat((+e.endAmount).mul(100)):"".concat((+e.startAmount).mul(100));return{type:e.conditionType,compare:e.relation,value:u}}(e)}))};if(t.state.drawerModel.node_value=Z()(a),console.log("更新后节点数据",t.state.drawerModel),t.state.priority!=t.state.drawerModel.node_option){var c=t.state.drawerModel.node_option.replace("优先级","")-1,s=t.state.priority.replace("优先级","")-1;t.props.onChangePriority(c,s)}t.props.onSubmit(t.state.drawerModel)}}else O.ZP.warn("请添加条件")},t.onTitleBlur=function(){t.setState({titleEditable:!1})},t.onTitleEdit=function(){t.setState({titleEditable:!0},(function(){t.inputRef.current.focus()}))},t.onTitleChange=function(e){t.state.drawerModel.node_name=e.target.value,t.setState({drawerModel:t.state.drawerModel})},t.onCloseDrawer=function(){t.props.onCloseDrawer()},t.onPriorityChange=function(e){t.setState({priority:e})},t.closeMember=function(){t.setState({memberSelectorVisible:!1})},t.closeDepartSelector=function(){t.setState({departSelectorVisible:!1})},t.closeInvoiceTitleSelector=function(){t.setState({invoiceTitleSelectorVisible:!1})},t.closeFeeTypeSelector=function(){t.setState({feeTypeSelectorVisible:!1})},t.closeTravelTypeSelector=function(){t.setState({travelTypeSelectorVisible:!1})},t.closeTravelModeSelector=function(){t.setState({travelModeSelectorVisible:!1})},t.showMemberSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({memberSelectorVisible:!0,conditionIndex:n}),t.editMemberRef.current.wrappedInstance.setCheck(e.filter((function(e){return!e.leave})))},t.showDepartSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({departSelectorVisible:!0,conditionIndex:n}),t.editDepartRef.current.wrappedInstance.setCheck(e)},t.showInvoiceSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({invoiceTitleSelectorVisible:!0,conditionIndex:n}),t.invoiceTitleSelectorRef.current.setChecked(e)},t.showTravelTypeSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({travelTypeSelectorVisible:!0,conditionIndex:n});var i=[],r=i.filter((function(e){return"travel_type"===e.field})).map((function(e){return{label:e.label,value:e.value}}));t.travelTypeRef.current.setChecked(e.filter((function(e){return r.some((function(t){return t.value===e.value}))})))},t.showTravelModeSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({travelModeSelectorVisible:!0,conditionIndex:n});var i=[],r=i.filter((function(e){return"travel_way"===e.field})).map((function(e){return{label:e.label,value:e.value}}));t.travelModeRef.current.setChecked(e.filter((function(e){return r.some((function(t){return t.value===e.value}))})))},t.showFeeTypeSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({feeTypeSelectorVisible:!0,conditionIndex:n}),t.feeTypeSelectorRef.current.setChecked(e)},t.memberSelectorCallback=function(e){if(e.length>20)O.ZP.warn("最多可添加20个成员");else{var n=t.state.conditionIndex;t.formRef.current.getFieldsValue().conditions[n].members=e.map((function(e){return{type:e.type,id:e.id.toString(),name:"string"==typeof e.name?e.name:e.name.props.children}})),t.setState({memberSelectorVisible:!1})}},t.departSelectorCallback=function(e){var n=t.state.conditionIndex;t.formRef.current.getFieldsValue().conditions[n].departs=e.map((function(e){return{type:e.type,id:e.id,name:"string"==typeof e.name?e.name:e.name.props.children}})),t.setState({departSelectorVisible:!1})},t.invoiceTitleSelectedCallback=function(e){var n=t.state.conditionIndex;t.formRef.current.getFieldsValue().conditions[n].titles=e.map((function(e){return{enterprise_title_id:e.enterprise_title_id,enterprise_name:e.enterprise_name}}))},t.feeTypeSelectedCallback=function(e){var n=t.state.conditionIndex;console.log(e),t.formRef.current.getFieldsValue().conditions[n].feeData=e.map((function(e){return{fee_type:e.fee_type,fee_name:e.fee_name}}))},t.travelTypeSelectorCallback=function(e){var n=t.state.conditionIndex;console.log(e),t.formRef.current.getFieldsValue().conditions[n].travelTypeData=e},t.travelModeSelectorCallback=function(e){var n=t.state.conditionIndex;console.log(e),t.formRef.current.getFieldsValue().conditions[n].travelModeData=e},t.showRoleSelector=function(e){t.setState({conditionIndex:e,roleSelectorVisible:!0})},t.onHideRolePicker=function(){t.setState({roleSelectorVisible:!1})},t.roleSelectorCallback=function(){var e=S()(T().mark((function e(n){var i,r;return T().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:i=t.state.conditionIndex,(r=t.formRef.current.getFieldsValue().conditions)[i].roles=n.map((function(e){return{role_id:e.role_id,role_name:"string"==typeof e.role_name?e.role_name:e.role_name.props.children}})),t.setState({roleSelectorVisible:!1,roles:r[i].roles});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.initData=function(){t.formRef.current.setFieldsValue({conditions:t.state.conditions})},t.getCurrFields=function(){return t.formRef.current.getFieldsValue().conditions||[]},t.onFormValuesChange=function(e,n){var i=n.conditions,r=(void 0===i?[]:i).map((function(e){return e&&e.conditionType}));t.setState({parentFields:r})},t.generateConfList=function(){return(0,L.jsx)(H.Z,{name:"dynamic_form_nest_item",ref:t.formRef,onValuesChange:t.onFormValuesChange,onFinish:t.onFinish,autoComplete:"off",children:(0,L.jsx)(H.Z.List,{name:"conditions",children:function(e,n){var i=n.add,r=n.remove;return(0,L.jsxs)("div",{children:[e.map((function(e,n){return(0,L.jsxs)("span",{style:{display:"flex"},children:[(0,L.jsx)(H.Z.Item,Q(Q({},e),{},{style:{flex:1},children:(0,L.jsx)(q.default,{index:n,showMemberSelector:t.showMemberSelector,showInvoiceSelector:t.showInvoiceSelector,showFeeTypeSelector:t.showFeeTypeSelector,showDepartSelector:t.showDepartSelector,getParentFields:t.getCurrFields,parentFields:t.state.parentFields,showTravelModeSelector:t.showTravelModeSelector,showTravelTypeSelector:t.showTravelTypeSelector,showRoleSelector:t.showRoleSelector,cityConfigList:t.state.cityConfigData,conditionLabelMap:t.props.conditionLabelMap})})),(0,L.jsx)("span",{className:"condition-edit-close",onClick:function(){r(e.name)}})]},e.key)})),(0,L.jsx)(H.Z.Item,{children:(0,L.jsxs)(Y.Z,{onClick:function(){i()},block:!0,type:"primary",className:"add-condition",children:[(0,L.jsx)($.Z,{})," 添加条件"]})})]})}})})},t.state={drawerModel:(0,E.p$)(t.props.drawerData),titleEditable:!1,lineNodesConfig:(0,E.p$)(t.props.lineNodesConfig),conditions:[],memberSelectorVisible:!1,departSelectorVisible:!1,invoiceTitleSelectorVisible:!1,travelTypeSelectorVisible:!1,travelModeSelectorVisible:!1,roleSelectorVisible:!1,treeData:[],conditionIndex:-1,invoiceTitleData:[],feeTypeData:[],cityConfigData:[],roles:[],parentFields:[],feeTypeSelectorVisible:!1,priority:t.props.drawerData.node_option};var n=(0,E.qW)([],"已删除");if(t.state.drawerModel.node_value){var o=(JSON.parse(t.state.drawerModel.node_value).conditions||[]).map((function(e){if(e.type==J.l9){var i=e.value.split(",");return i=i.map((function(e){var t=e.split("#"),n=b()(t,3);return{id:n[0],name:n[1],leave:n[2]}})),{conditionType:e.type,relation:e.compare,members:i}}if(e.type===J.Bv){var r=e.value.split(",");return r=r.map((function(e){var t=e.split("#"),n=b()(t,3);return{role_id:n[0],role_name:n[1],is_del:"true"===n[2]||void 0}})),t.state.roles=r,{conditionType:e.type,relation:e.compare,roles:r}}if(e.type==J.Fr){var o=e.value.split(",");return o=o.map((function(e){var t=e.split("#"),n=b()(t,2);return{type:2,id:n[0],name:n[1]}})),{conditionType:e.type,relation:e.compare,departs:o}}if(e.type==J.Al){var l=e.value.split(",");return l=l.map((function(e){var t=e.split("#"),n=b()(t,2);return{enterprise_title_id:n[0],enterprise_name:n[1]}})),{conditionType:e.type,relation:e.compare,titles:l}}if(e.type==J.lt){var a=e.value.split(",");return a=a.map((function(e){var t=e.split("#"),n=b()(t,2);return{fee_type:n[0],fee_name:n[1]}})),{conditionType:e.type,relation:e.compare,feeData:a}}if(e.type==J.w7){var c=e.value.split(",");return c=c.map((function(e){return{label:n(e),value:e}})),{conditionType:e.type,relation:e.compare,travelModeData:c}}if(e.type==J.NY){var s=e.value.split(",");return s=s.map((function(e){return{label:n(e),value:e}})),{conditionType:e.type,relation:e.compare,travelTypeData:s}}if(e.type==J.l2){var u=e.value.split(",");return{conditionType:e.type,relation:e.compare,officeLocationData:u}}if(e.type==J.j4){var d=e.value&&e.value.split(","),p=b()(d,2),f=p[0],v=p[1];return{conditionType:e.type,relation:e.compare,startAmount:f?+f:null,endAmount:v?+v:null}}var m=e.value&&e.value.split(","),h=b()(m,2),y=h[0],x=h[1];return{conditionType:e.type,relation:e.compare,startAmount:y?(+y).div(100):null,endAmount:x?(+x).div(100):null}}));console.log("初始化后conditions列表",o),t.state.conditions=o}return t}return A()(r,[{key:"componentDidMount",value:function(){this.initData()}},{key:"render",value:function(){var e=this,t=this.state,n=t.titleEditable,i=t.drawerModel,r=t.lineNodesConfig,o=(t.treeData,t.memberSelectorVisible,t.departSelectorVisible,t.invoiceTitleData,t.feeTypeData,t.priority),l=t.roles,a=void 0===l?[]:l,c=(t.roleSelectorVisible,[]),s=c.filter((function(e){return"travel_type"===e.field})).map((function(e){return{label:e.label,value:e.value}}));return c.filter((function(e){return"travel_way"===e.field})).map((function(e){return{label:e.label,value:e.value}})),console.log(s),a.map((function(e){return Q(Q({},e),{},{key:e.role_id,title:e.role_name})})),(0,L.jsxs)("div",{className:"condition-edit-drawer_contailer",children:[(0,L.jsxs)("div",{className:"drawer-header",children:[(0,L.jsxs)("div",{className:"left-header",children:[(0,L.jsxs)(G.Z,{visible:!n,children:[(0,L.jsx)("span",{className:"edit-title",children:i.node_name}),(0,L.jsx)("span",{className:"edit-icon",onClick:this.onTitleEdit,style:{marginLeft:10}})]}),(0,L.jsx)(G.Z,{visible:n,children:(0,L.jsx)(W.Z,{maxLength:20,value:i.node_name,ref:this.inputRef,onChange:this.onTitleChange,onBlur:this.onTitleBlur,style:{width:300}})})]}),(0,L.jsx)(B.Z,{className:"priority",onChange:this.onPriorityChange,value:o,children:r.currentNodes.lineNodes.slice(0,-1).map((function(e){return(0,L.jsx)(U,{value:e.node_option,children:e.node_option},e.node_option)}))}),(0,L.jsx)(z.Z,{placement:"bottomLeft",children:(0,L.jsx)("span",{children:"首先匹配“优先级1”的条件。如果匹配成功则审批单发送给该条件下的审批人和抄送人；如果匹配不成功则继续进行匹配下一优先级的条件。"})})]}),(0,L.jsxs)("div",{className:"drawer-content-wrapper",children:[(0,L.jsx)("h1",{style:{fontSize:16},children:"同时满足以下条件"}),this.generateConfList()]}),(0,L.jsxs)("div",{className:"button-bar",children:[(0,L.jsx)(Y.Z,{type:"primary",onClick:function(){e.submit()},children:"确定"}),(0,L.jsx)(Y.Z,{onClick:this.onCloseDrawer,children:"取消"})]})]})}}]),r}(I.Component)},17803:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var i=n(58548),r=n.n(i),o=n(78829),l=n.n(o),a=n(51765),c=n.n(a),s=n(93287),u=n.n(s),d=n(24309),p=n.n(d),f=n(33929),v=n.n(f),m=n(69984),h=n.n(m),y=n(48550),b=n.n(y),x=n(85893),g=n(67294),_=n(75837),T=n(34041),j=n(14617),S=n(58975),w=n(80129),Z=n.n(w),k=n(7791);function C(e,t){var n=v()(e);if(p()){var i=p()(e);t&&(i=i.filter((function(t){return u()(e,t).enumerable}))),n.push.apply(n,i)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):c()?l()(e,c()(n)):C(Object(n)).forEach((function(t){r()(e,t,u()(n,t))}))}return e}var A=_.Z.TreeNode,N=T.Z.Option;const R=function(e){var t=e.value,n=void 0===t?{}:t,i=e.onChange,r=e.showMemberSelector,o=e.index,l=e.showRoleSelector,a=e.showInvoiceSelector,c=e.parentFields,s=e.showFeeTypeSelector,u=e.showDepartSelector,d=e.showTravelTypeSelector,p=e.showTravelModeSelector,f=e.cityConfigList,v=e.conditionLabelMap,m=(0,g.useState)(n.relation),h=b()(m,2),y=h[0],w=h[1],C=(0,g.useState)(n.conditionType),R=b()(C,2),M=R[0],V=R[1],P=(0,g.useState)(n.startAmount),F=b()(P,2),L=F[0],I=F[1],E=(0,g.useState)(n.endAmount),G=b()(E,2),B=G[0],O=G[1],H=(0,g.useState)(n.officeLocationData),Y=b()(H,2),W=Y[0],$=Y[1],z=[];switch(n.conditionType){case k.l9:case k.Fr:case k.Al:case k.l2:case k.NY:case k.Bv:z=k.zH;break;case k.lt:case k.w7:z=k.ve;break;case k.j4:default:z=k.J_}var J=(0,g.useState)(z),q=b()(J,2),K=q[0],Q=q[1],U=n.members,X=void 0===U?[]:U,ee=n.roles,te=void 0===ee?[]:ee,ne=n.departs,ie=void 0===ne?[]:ne,re=n.titles,oe=void 0===re?[]:re,le=n.feeData,ae=void 0===le?[]:le,ce=n.travelModeData,se=void 0===ce?[]:ce,ue=n.travelTypeData,de=void 0===ue?[]:ue,pe=Z().parse(window.location.search,{ignoreQueryPrefix:!0}).doc_tmpl_type,fe=k.S_.filter((function(e){return"ALL"===e.template_types||e.template_types.includes(+pe)}));(0,g.useEffect)((function(){var e;(function(e){if(null==e)return!0})(M)||(e={conditionType:M,relation:y,officeLocationData:W,startAmount:L,endAmount:B},i&&i(D(D({conditionType:M,relation:y},n),e)))}),[M,y,W,L,B]);var ve=function(e){I(e.target.value)},me=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=[];return t.length>0&&t.forEach((function(t){t.child?i.push((0,x.jsx)(A,{isLeaf:!1,selectable:!1,value:"".concat(n,"|").concat(t.name),title:t.name,children:e(t.child,t.name)},"".concat(t.name,"parent"))):i.push((0,x.jsx)(A,{isLeaf:!0,value:"".concat(n,"|").concat(t.name),title:t.name},"".concat(t.name,"child")))})),i}(f);return(0,x.jsxs)("span",{className:"condition-edit-wrap",style:{display:"flex"},children:[(0,x.jsx)(T.Z,{value:n.conditionType||M,placeholder:"请选择条件",onChange:function(e){switch(V(e),e){case k.l9:case k.Fr:case k.Al:case k.l2:case k.NY:case k.Bv:Q(k.zH),w(k.zH[0].value);break;case k.lt:case k.w7:Q(k.ve),w(k.ve[0].value);break;case k.j4:default:Q(k.J_),w(k.J_[0].value)}I(null),O(null)},className:"condition-type-select",children:fe.map((function(e){return(0,x.jsx)(N,{value:e.value,disabled:c.includes(e.value),children:v[e.field]||e.label},e.value)}))}),(0,x.jsx)(S.Z,{visible:void 0!==n.conditionType&&null!==n.conditionType,children:(0,x.jsx)(T.Z,{value:n.relation||y,className:"condition-relation-select",onChange:function(e){w(e)},children:K.map((function(e){return(0,x.jsx)(N,{value:e.value,children:e.label},e.value)}))})}),(0,x.jsx)(S.Z,{visible:n.conditionType===k.l9,children:(0,x.jsxs)("div",{className:"condition-edit-mem-sel",onClick:function(){r(X,o)},children:[(0,x.jsx)(S.Z,{visible:X.length>0,children:(0,x.jsx)("div",{children:X.map((function(e){return(0,x.jsx)("span",{className:"condition-edit-member-styl",children:(0,x.jsx)("span",{className:"condition-edit-item-content ".concat(e.leave?"quit":""),children:"".concat(e.name).concat(e.leave?"(已离职)":"")})},e.id)}))})}),(0,x.jsx)(S.Z,{visible:0===X.length,children:"添加成员+"})]})}),(0,x.jsx)(S.Z,{visible:n.conditionType===k.Bv,children:(0,x.jsxs)("div",{className:"condition-edit-mem-sel",onClick:function(){l(o)},children:[(0,x.jsx)(S.Z,{visible:te.length>0,children:(0,x.jsx)("div",{children:te.map((function(e){return(0,x.jsx)("span",{className:"condition-edit-member-styl",children:(0,x.jsx)("span",{className:"condition-edit-item-content ".concat(e.is_del?"quit":""),children:"".concat(e.role_name).concat(e.is_del?"(已删除)":"")})},e.role_id)}))})}),(0,x.jsx)(S.Z,{visible:0===te.length,children:"添加+"})]})}),(0,x.jsx)(S.Z,{visible:n.conditionType===k.Fr,children:(0,x.jsxs)("div",{className:"condition-edit-mem-sel",onClick:function(){u(ie,o)},children:[(0,x.jsx)(S.Z,{visible:ie.length>0,children:(0,x.jsx)("div",{children:ie.map((function(e){return(0,x.jsx)("span",{className:"condition-edit-member-styl",children:e.name},e.id)}))})}),(0,x.jsx)(S.Z,{visible:0===ie.length,children:"添加部门+"})]})}),(0,x.jsx)(S.Z,{visible:n.conditionType===k.Al,children:(0,x.jsxs)("div",{className:"condition-edit-mem-sel",onClick:function(){a(oe,o)},children:[(0,x.jsx)(S.Z,{visible:oe.length>0,children:(0,x.jsx)("div",{children:oe.map((function(e){return(0,x.jsx)("span",{className:"condition-edit-member-styl",children:e.enterprise_name},e.enterprise_title_id)}))})}),(0,x.jsx)(S.Z,{visible:0===oe.length,children:"选择公司抬头+"})]})}),(0,x.jsx)(S.Z,{visible:n.conditionType===k.lt,children:(0,x.jsxs)("div",{className:"condition-edit-mem-sel",onClick:function(){s(ae,o)},children:[(0,x.jsx)(S.Z,{visible:ae.length>0,children:(0,x.jsx)("div",{children:ae.map((function(e){return(0,x.jsx)("span",{className:"condition-edit-member-styl",children:e.fee_name},e.fee_type)}))})}),(0,x.jsx)(S.Z,{visible:0===ae.length,children:"选择费用类型+"})]})}),(0,x.jsx)(S.Z,{visible:n.conditionType===k.w7,children:(0,x.jsxs)("div",{className:"condition-edit-mem-sel",onClick:function(){p(se,o)},children:[(0,x.jsx)(S.Z,{visible:se.length>0,children:(0,x.jsx)("div",{children:se.map((function(e){return(0,x.jsx)("span",{className:"condition-edit-member-styl",children:e.label},e.value)}))})}),(0,x.jsx)(S.Z,{visible:0===se.length,children:"选择出行方式+"})]})}),(0,x.jsx)(S.Z,{visible:n.conditionType===k.NY,children:(0,x.jsxs)("div",{className:"condition-edit-mem-sel",onClick:function(){d(de,o)},children:[(0,x.jsx)(S.Z,{visible:de.length>0,children:(0,x.jsx)("div",{children:de.map((function(e){return(0,x.jsx)("span",{className:"condition-edit-member-styl",children:e.label},e.value)}))})}),(0,x.jsx)(S.Z,{visible:0===de.length,children:"选择出行类型+"})]})}),(0,x.jsx)(S.Z,{visible:n.conditionType===k.l2,children:(0,x.jsx)(_.Z,{placeholder:"请选择办公地点",multiple:!0,style:{flex:1},value:W,onChange:function(e,t,n){$(e),console.log(W),console.log(e,t,n)},children:me})}),(0,x.jsx)(S.Z,{visible:function(e){switch(e){case k.Bc:case k.j4:return!0;default:return!1}}(n.conditionType),children:(0,x.jsxs)("div",{style:{flex:1},children:[(0,x.jsx)(S.Z,{visible:n.relation!==k.xG,children:(0,x.jsx)(j.Z,{className:"single-input",placeholder:n.conditionType===k.j4?"出差时长（小时）":null,type:"number",value:n.startAmount||L,onChange:ve})}),(0,x.jsxs)(S.Z,{visible:n.relation===k.xG,children:[(0,x.jsx)(j.Z,{className:"double-input-inline",placeholder:n.conditionType===k.j4?"出差时长（小时）":null,type:"number",value:n.startAmount||L,onChange:ve}),(0,x.jsx)("span",{className:"input-split",children:"-"}),(0,x.jsx)(j.Z,{className:"double-input-inline",placeholder:n.conditionType===k.j4?"出差时长（小时）":null,type:"number",value:n.endAmount||B,onChange:function(e){O(e.target.value)}})]})]})})]})}},7791:(e,t,n)=>{n.d(t,{Al:()=>C,Bc:()=>D,Bv:()=>P,Dw:()=>v,EN:()=>h,EZ:()=>b,Fr:()=>k,J_:()=>G,KT:()=>a,LI:()=>w,MZ:()=>y,NY:()=>R,Oh:()=>u,PC:()=>d,S_:()=>F,WD:()=>l,d:()=>m,dA:()=>f,du:()=>g,j4:()=>V,k0:()=>p,l2:()=>M,l9:()=>Z,lf:()=>j,lt:()=>A,ok:()=>T,ux:()=>s,ve:()=>I,w7:()=>N,w9:()=>S,xG:()=>E,xV:()=>c,y5:()=>_,yl:()=>x,zH:()=>L});var i=n(74720),r=n.n(i),o=function(e){e=e||32;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=t.length,i="",r=0;r<e;r++)i+=t.charAt(Math.floor(Math.random()*n));return i},l="APPLICANT_NODE",a="ROUTER_NODE",c="END",s=1,u=3,d=4,p=5,f=6,v=1,m=3,h=2,y=4,b=[v,h,y],x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t={user_type:e};return e===h&&(t.level_num="3",t.level_type=1),{node_type:s,key:o(),node_name:"主管审批",child_nodes:[],node_option:"",node_value:r()(t)}},g=function(){return{node_type:u,key:o(),node_name:"财务审核",child_nodes:[],node_option:"",node_value:r()({user_type:1,sign_method:2})}},_=function(){return{node_type:p,key:o(),node_name:"抄送人",child_nodes:[],node_option:"",node_value:r()({})}},T=function(){return{node_type:d,key:o(),node_name:"出纳支付",child_nodes:[],node_option:"",node_value:r()({user_type:1,pay_status:1})}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"条件1",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"优先级1",i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r="";return{node_type:f,child_nodes:e,key:o(),node_name:t,node_option:n,node_value:r,default:i}},S=[{label:"直接主管",value:"1"},{label:"第2级主管",value:"2"},{label:"第3级主管",value:"3"},{label:"第4级主管",value:"4"},{label:"第5级主管",value:"5"},{label:"第6级主管",value:"6"},{label:"第7级主管",value:"7"},{label:"第8级主管",value:"8"}],w=[{label:"最高层级主管",value:"1"},{label:"第2个层级主管",value:"2"},{label:"第3个层级主管",value:"3"},{label:"第4个层级主管",value:"4"},{label:"第5个层级主管",value:"5"},{label:"第6个层级主管",value:"6"},{label:"第7个层级主管",value:"7"},{label:"第8个层级主管",value:"8"}],Z=1,k=2,C=3,D=4,A=5,N=6,R=7,M=8,V=9,P=10,F=[{label:"申请人",value:Z,template_types:"ALL",field:"commiter"},{label:"费用部门",value:k,template_types:"ALL",field:"department"},{label:"公司抬头",value:C,template_types:"ALL",field:"title"},{label:"报销金额",value:D,template_types:[1],field:"amount"},{label:"招待金额",value:D,template_types:[2],field:"amount"},{label:"付款金额",value:D,template_types:[4]},{label:"借款金额",value:D,template_types:[3],field:"amount"},{label:"出行方式",value:N,template_types:[2],field:"trans_way"},{label:"出行类型",value:R,template_types:[2],field:"travel_type"},{label:"费用类型",value:A,template_types:[1,4]},{label:"办公地点",value:M,template_types:"ALL"},{label:"出差时长",value:V,template_types:[2]},{label:"用户组",value:P,template_types:"ALL"}],L=[{label:"属于",value:1},{label:"不属于",value:2}],I=[{label:"包含",value:9},{label:"不包含",value:10}],E=8,G=[{label:"大于",value:3},{label:"大于等于",value:4},{label:"等于",value:5},{label:"小于",value:7},{label:"小于等于",value:6},{label:"介于",value:E}]}}]);