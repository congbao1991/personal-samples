(self.webpackChunkreact_webpack=self.webpackChunkreact_webpack||[]).push([[676],{34046:(e,t,n)=>{"use strict";n.d(t,{Z:()=>y});var a=n(63497),r=n.n(a),l=n(9830),i=n.n(l),o=n(30695),c=n.n(o),u=n(83507),s=n.n(u),d=n(69024),p=n.n(d),m=n(600),f=n.n(m),v=n(67294);var y=function(e){s()(l,e);var t,n,a=(t=l,n=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(r()(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=f()(t);if(n){var l=f()(this).constructor;e=r()(a,arguments,l)}else e=a.apply(this,arguments);return p()(this,e)});function l(){return i()(this,l),a.apply(this,arguments)}return c()(l,[{key:"render",value:function(){var e=this.props,t=e.visible,n=e.children,a=t?n:null;return v.createElement(v.Fragment,null,a)}}]),l}(v.PureComponent)},88675:(e,t,n)=>{"use strict";n.d(t,{Z:()=>S});var a=n(63497),r=n.n(a),l=n(71649),i=n.n(l),o=n(11845),c=n.n(o),u=n(9830),s=n.n(u),d=n(30695),p=n.n(d),m=n(83507),f=n.n(m),v=n(69024),y=n.n(v),b=n(600),h=n.n(b),g=n(67294),_=n(31097),T=n(80411),E=n.n(T);var S=function(e){f()(l,e);var t,n,a=(t=l,n=function(){if("undefined"==typeof Reflect||!r())return!1;if(r().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(r()(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=h()(t);if(n){var l=h()(this).constructor;e=r()(a,arguments,l)}else e=a.apply(this,arguments);return y()(this,e)});function l(){return s()(this,l),a.apply(this,arguments)}return p()(l,[{key:"render",value:function(){var e=this.props,t=(e.content,e.minHgWid),n=void 0===t?20:t,a=e.children,r=e.bgOpacity,l=void 0!==r&&r,o=c()(e,["content","minHgWid","children","bgOpacity"]),u=g.createElement("div",{className:"hover-tips-content"},a);return g.createElement(_.Z,i()({title:u,className:"hover-tips-popover"},o),g.createElement("div",{id:"hover-tips",className:E()({"bg-opacity":l}),style:{minHeight:n,minWidth:n}}))}}]),l}(g.Component)},41584:(e,t,n)=>{"use strict";n.d(t,{p$:()=>u,qW:()=>s,xb:()=>d}),n(74720);var a=n(33929),r=n.n(a),l=n(24422),i=n.n(l),o=(n(94504),n(94100),n(94513)),c=n.n(o);function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function n(e,t){return e.filter(t)[0]}if(null===e||"object"!==c()(e))return e;var a=n(t,(function(t){return t.original===e}));if(a)return a.copy;var l=i()(e)?[]:{};return t.push({original:e,copy:l}),r()(e).forEach((function(n){l[n]=u(e[n],t)})),l}n(89060),n(93133),n(49204);var s=function(e,t){return function(n){if(""===n||null==n)return"";var a=e.find((function(e){return e.value==n}));return a?a.label:t||n}};function d(e){return null==e}},26676:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>ee});var a=n(58548),r=n.n(a),l=n(78829),i=n.n(l),o=n(51765),c=n.n(o),u=n(93287),s=n.n(u),d=n(24309),p=n.n(d),m=n(33929),f=n.n(m),v=n(63497),y=n.n(v),b=n(69984),h=n.n(b),g=n(48550),_=n.n(g),T=n(71649),E=n.n(T),S=n(10490),w=n.n(S),k=n(27802),Z=n.n(k),C=n(74720),D=n.n(C),A=n(9830),N=n.n(A),x=n(30695),R=n.n(x),M=n(83507),V=n.n(M),P=n(69024),F=n.n(P),L=n(600),I=n.n(L),j=n(67294),G=n(41584),B=n(34046),O=n(34041),H=n(48086),Y=n(32478),W=n(71577),$=n(14617),z=n(49101),J=n(88675),q=n(45724),K=n(71621);function Q(e,t){var n=f()(e);if(p()){var a=p()(e);t&&(a=a.filter((function(t){return s()(e,t).enumerable}))),n.push.apply(n,a)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):c()?i()(e,c()(n)):Q(Object(n)).forEach((function(t){r()(e,t,s()(n,t))}))}return e}var X=O.Z.Option;const ee=function(e){V()(r,e);var t,n,a=(t=r,n=function(){if("undefined"==typeof Reflect||!y())return!1;if(y().sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(y()(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,a=I()(t);if(n){var r=I()(this).constructor;e=y()(a,arguments,r)}else e=a.apply(this,arguments);return F()(this,e)});function r(e){var t;N()(this,r),(t=a.call(this,e)).inputRef=(0,j.createRef)(),t.formRef=j.createRef(),t.editMemberRef=j.createRef(),t.editDepartRef=j.createRef(),t.invoiceTitleSelectorRef=j.createRef(),t.feeTypeSelectorRef=j.createRef(),t.travelTypeRef=j.createRef(),t.travelModeRef=j.createRef(),t.submit=function(){var e=t.formRef.current.getFieldsValue().conditions,n=[q.Fr,q.l9,q.lt,q.Al,q.w7,q.NY,q.l2,q.Bv];if(console.log(e),e&&0!=e.length){for(var a=!0,r=0;r<e.length;r++){if(!e[r]){a=!1,H.ZP.warn("请选择条件");break}if(e[r].conditionType==q.l9&&(e[r].members=(e[r].members||[]).filter((function(e){return!e.leave}))),e[r].conditionType==q.l9&&(!e[r].members||0==e[r].members.length)){a=!1,H.ZP.warn("请选择申请人");break}if(!(e[r].conditionType!=q.Fr||e[r].departs&&0!=e[r].departs.length)){a=!1,H.ZP.warn("请选择费用部门");break}if(!(e[r].conditionType!=q.lt||e[r].feeData&&0!=e[r].feeData.length)){a=!1,H.ZP.warn("请选择费用类型");break}if(!(e[r].conditionType!=q.Bv||e[r].roles&&0!=e[r].roles.length)){a=!1,H.ZP.warn("请选择角色");break}if(e[r].conditionType==q.Bv&&e[r].roles.some((function(e){return e.is_del}))){a=!1,H.ZP.warn("有已删除角色配置，请作更改");break}if(!(e[r].conditionType!=q.Al||e[r].titles&&0!=e[r].titles.length)){a=!1,H.ZP.warn("请选择公司抬头");break}if(!(e[r].conditionType!=q.w7||e[r].travelModeData&&0!=e[r].travelModeData.length)){a=!1,H.ZP.warn("请选择出行方式");break}if(!(e[r].conditionType!=q.NY||e[r].travelTypeData&&0!=e[r].travelTypeData.length)){a=!1,H.ZP.warn("请选择出行类型");break}if(!(e[r].conditionType!=q.l2||e[r].officeLocationData&&0!=e[r].officeLocationData.length)){a=!1,H.ZP.warn("请选择办公地点");break}if(e[r].conditionType==q.j4){if(!e[r].startAmount||e[r].relation==q.xG&&!e[r].endAmount){a=!1,H.ZP.warn("请输入出差时长");break}if(e[r].relation==q.xG&&(e[r].startAmount<=0||e[r].endAmount<=0)){a=!1,H.ZP.warn("请输入大于0整数");break}if(e[r].relation!=q.xG&&e[r].startAmount<=0){a=!1,H.ZP.warn("请输入大于0整数");break}var l=/^[0-9]+$/;if(!(e[r].relation!=q.xG||l.test(e[r].startAmount)&&l.test(e[r].endAmount))){a=!1,H.ZP.warn("请输入大于0整数");break}if(e[r].relation!=q.xG&&!l.test(e[r].startAmount)){a=!1,H.ZP.warn("请输入大于0整数");break}if(e[r].relation==q.xG&&(e[r].startAmount.toString().length>15||e[r].endAmount.length>15)){a=!1,H.ZP.warn("时长输入长度不能大于15位");break}if(e[r].relation!=q.xG&&e[r].startAmount.toString().length>15){a=!1,H.ZP.warn("时长输入长度不能大于15位");break}}else if(!n.includes(e[r].conditionType)){if(!e[r].startAmount||e[r].relation==q.xG&&!e[r].endAmount){a=!1,H.ZP.warn("请输入金额");break}if(e[r].relation==q.xG&&(e[r].startAmount<=0||e[r].endAmount<=0)){a=!1,H.ZP.warn("请输入大于0的金额");break}if(e[r].relation!=q.xG&&e[r].startAmount<=0){a=!1,H.ZP.warn("请输入大于0的金额");break}var i=/(^[1-9](\d+)?(\.\d{1,2})?$)|(^0$)|(^\d\.\d{1,2}$)/;if(!(e[r].relation!=q.xG||i.test(e[r].startAmount)&&i.test(e[r].endAmount))){a=!1,H.ZP.warn("请输入正确的金额");break}if(e[r].relation!=q.xG&&!i.test(e[r].startAmount)){a=!1,H.ZP.warn("请输入正确的金额");break}if(e[r].relation==q.xG&&(e[r].startAmount.toString().length>15||e[r].endAmount.length>15)){a=!1,H.ZP.warn("金额输入长度不能大于15位");break}if(e[r].relation!=q.xG&&e[r].startAmount.toString().length>15){a=!1,H.ZP.warn("金额输入长度不能大于15位");break}}}if(a){var o={conditions:e.map((function(e){return function(e){if(e.conditionType===q.l9){var t=e.members.filter((function(e){return!e.leave})).map((function(e){return"".concat(e.id,"#").concat(e.name)}));return{type:e.conditionType,compare:e.relation,value:t.join(",")}}if(e.conditionType===q.Fr){var n=e.departs.map((function(e){return"".concat(e.id,"#").concat(e.name)}));return{type:e.conditionType,compare:e.relation,value:n.join(",")}}if(e.conditionType===q.Al){var a=e.titles.map((function(e){return"".concat(e.enterprise_title_id,"#").concat(e.enterprise_name)}));return{type:e.conditionType,compare:e.relation,value:a.join(",")}}if(e.conditionType===q.lt){var r=e.feeData.map((function(e){return"".concat(e.fee_type,"#").concat(e.fee_name)}));return{type:e.conditionType,compare:e.relation,value:r.join(",")}}if(e.conditionType===q.w7){var l=e.travelModeData.map((function(e){return"".concat(e.value)}));return{type:e.conditionType,compare:e.relation,value:l.join(",")}}if(e.conditionType===q.NY){var i=e.travelTypeData.map((function(e){return"".concat(e.value)}));return{type:e.conditionType,compare:e.relation,value:i.join(",")}}if(e.conditionType===q.l2){var o=e.officeLocationData;return{type:e.conditionType,compare:e.relation,value:o.join(",")}}if(e.conditionType===q.j4){var c=e.relation==q.xG?"".concat(+e.startAmount,",").concat(+e.endAmount):"".concat(+e.startAmount);return{type:e.conditionType,compare:e.relation,value:c}}if(e.conditionType===q.Bv){var u=e.roles.map((function(e){return"".concat(e.role_id,"#").concat(e.role_name)}));return{type:e.conditionType,compare:e.relation,value:u.join(",")}}var s=e.relation==q.xG?"".concat((+e.startAmount).mul(100),",").concat((+e.endAmount).mul(100)):"".concat((+e.startAmount).mul(100));return{type:e.conditionType,compare:e.relation,value:s}}(e)}))};if(t.state.drawerModel.node_value=D()(o),console.log("更新后节点数据",t.state.drawerModel),t.state.priority!=t.state.drawerModel.node_option){var c=t.state.drawerModel.node_option.replace("优先级","")-1,u=t.state.priority.replace("优先级","")-1;t.props.onChangePriority(c,u)}t.props.onSubmit(t.state.drawerModel)}}else H.ZP.warn("请添加条件")},t.onTitleBlur=function(){t.setState({titleEditable:!1})},t.onTitleEdit=function(){t.setState({titleEditable:!0},(function(){t.inputRef.current.focus()}))},t.onTitleChange=function(e){t.state.drawerModel.node_name=e.target.value,t.setState({drawerModel:t.state.drawerModel})},t.onCloseDrawer=function(){t.props.onCloseDrawer()},t.onPriorityChange=function(e){t.setState({priority:e})},t.closeMember=function(){t.setState({memberSelectorVisible:!1})},t.closeDepartSelector=function(){t.setState({departSelectorVisible:!1})},t.closeInvoiceTitleSelector=function(){t.setState({invoiceTitleSelectorVisible:!1})},t.closeFeeTypeSelector=function(){t.setState({feeTypeSelectorVisible:!1})},t.closeTravelTypeSelector=function(){t.setState({travelTypeSelectorVisible:!1})},t.closeTravelModeSelector=function(){t.setState({travelModeSelectorVisible:!1})},t.showMemberSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({memberSelectorVisible:!0,conditionIndex:n}),t.editMemberRef.current.wrappedInstance.setCheck(e.filter((function(e){return!e.leave})))},t.showDepartSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({departSelectorVisible:!0,conditionIndex:n}),t.editDepartRef.current.wrappedInstance.setCheck(e)},t.showInvoiceSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({invoiceTitleSelectorVisible:!0,conditionIndex:n}),t.invoiceTitleSelectorRef.current.setChecked(e)},t.showTravelTypeSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({travelTypeSelectorVisible:!0,conditionIndex:n});var a=[],r=a.filter((function(e){return"travel_type"===e.field})).map((function(e){return{label:e.label,value:e.value}}));t.travelTypeRef.current.setChecked(e.filter((function(e){return r.some((function(t){return t.value===e.value}))})))},t.showTravelModeSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({travelModeSelectorVisible:!0,conditionIndex:n});var a=[],r=a.filter((function(e){return"travel_way"===e.field})).map((function(e){return{label:e.label,value:e.value}}));t.travelModeRef.current.setChecked(e.filter((function(e){return r.some((function(t){return t.value===e.value}))})))},t.showFeeTypeSelector=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;t.setState({feeTypeSelectorVisible:!0,conditionIndex:n}),t.feeTypeSelectorRef.current.setChecked(e)},t.memberSelectorCallback=function(e){if(e.length>20)H.ZP.warn("最多可添加20个成员");else{var n=t.state.conditionIndex;t.formRef.current.getFieldsValue().conditions[n].members=e.map((function(e){return{type:e.type,id:e.id.toString(),name:"string"==typeof e.name?e.name:e.name.props.children}})),t.setState({memberSelectorVisible:!1})}},t.departSelectorCallback=function(e){var n=t.state.conditionIndex;t.formRef.current.getFieldsValue().conditions[n].departs=e.map((function(e){return{type:e.type,id:e.id,name:"string"==typeof e.name?e.name:e.name.props.children}})),t.setState({departSelectorVisible:!1})},t.invoiceTitleSelectedCallback=function(e){var n=t.state.conditionIndex;t.formRef.current.getFieldsValue().conditions[n].titles=e.map((function(e){return{enterprise_title_id:e.enterprise_title_id,enterprise_name:e.enterprise_name}}))},t.feeTypeSelectedCallback=function(e){var n=t.state.conditionIndex;console.log(e),t.formRef.current.getFieldsValue().conditions[n].feeData=e.map((function(e){return{fee_type:e.fee_type,fee_name:e.fee_name}}))},t.travelTypeSelectorCallback=function(e){var n=t.state.conditionIndex;console.log(e),t.formRef.current.getFieldsValue().conditions[n].travelTypeData=e},t.travelModeSelectorCallback=function(e){var n=t.state.conditionIndex;console.log(e),t.formRef.current.getFieldsValue().conditions[n].travelModeData=e},t.showRoleSelector=function(e){t.setState({conditionIndex:e,roleSelectorVisible:!0})},t.onHideRolePicker=function(){t.setState({roleSelectorVisible:!1})},t.roleSelectorCallback=function(){var e=Z()(w().mark((function e(n){var a,r;return w().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}return e.abrupt("return");case 2:a=t.state.conditionIndex,(r=t.formRef.current.getFieldsValue().conditions)[a].roles=n.map((function(e){return{role_id:e.role_id,role_name:"string"==typeof e.role_name?e.role_name:e.role_name.props.children}})),t.setState({roleSelectorVisible:!1,roles:r[a].roles});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.initData=function(){t.formRef.current.setFieldsValue({conditions:t.state.conditions})},t.getCurrFields=function(){return t.formRef.current.getFieldsValue().conditions||[]},t.onFormValuesChange=function(e,n){var a=n.conditions,r=(void 0===a?[]:a).map((function(e){return e&&e.conditionType}));t.setState({parentFields:r})},t.generateConfList=function(){return j.createElement(Y.Z,{name:"dynamic_form_nest_item",ref:t.formRef,onValuesChange:t.onFormValuesChange,onFinish:t.onFinish,autoComplete:"off"},j.createElement(Y.Z.List,{name:"conditions"},(function(e,n){var a=n.add,r=n.remove;return j.createElement("div",null,e.map((function(e,n){return j.createElement("span",{style:{display:"flex"},key:e.key},j.createElement(Y.Z.Item,E()({},e,{style:{flex:1}}),j.createElement(K.default,{index:n,showMemberSelector:t.showMemberSelector,showInvoiceSelector:t.showInvoiceSelector,showFeeTypeSelector:t.showFeeTypeSelector,showDepartSelector:t.showDepartSelector,getParentFields:t.getCurrFields,parentFields:t.state.parentFields,showTravelModeSelector:t.showTravelModeSelector,showTravelTypeSelector:t.showTravelTypeSelector,showRoleSelector:t.showRoleSelector,cityConfigList:t.state.cityConfigData,conditionLabelMap:t.props.conditionLabelMap})),j.createElement("span",{className:"condition-edit-close",onClick:function(){r(e.name)}}))})),j.createElement(Y.Z.Item,null,j.createElement(W.Z,{onClick:function(){a()},block:!0,type:"primary",className:"add-condition"},j.createElement(z.Z,null)," 添加条件")))})))},t.state={drawerModel:(0,G.p$)(t.props.drawerData),titleEditable:!1,lineNodesConfig:(0,G.p$)(t.props.lineNodesConfig),conditions:[],memberSelectorVisible:!1,departSelectorVisible:!1,invoiceTitleSelectorVisible:!1,travelTypeSelectorVisible:!1,travelModeSelectorVisible:!1,roleSelectorVisible:!1,treeData:[],conditionIndex:-1,invoiceTitleData:[],feeTypeData:[],cityConfigData:[],roles:[],parentFields:[],feeTypeSelectorVisible:!1,priority:t.props.drawerData.node_option};var n=(0,G.qW)([],"已删除");if(t.state.drawerModel.node_value){var l=(JSON.parse(t.state.drawerModel.node_value).conditions||[]).map((function(e){if(e.type==q.l9){var a=e.value.split(",");return a=a.map((function(e){var t=e.split("#"),n=_()(t,3);return{id:n[0],name:n[1],leave:n[2]}})),{conditionType:e.type,relation:e.compare,members:a}}if(e.type===q.Bv){var r=e.value.split(",");return r=r.map((function(e){var t=e.split("#"),n=_()(t,3);return{role_id:n[0],role_name:n[1],is_del:"true"===n[2]||void 0}})),t.state.roles=r,{conditionType:e.type,relation:e.compare,roles:r}}if(e.type==q.Fr){var l=e.value.split(",");return l=l.map((function(e){var t=e.split("#"),n=_()(t,2);return{type:2,id:n[0],name:n[1]}})),{conditionType:e.type,relation:e.compare,departs:l}}if(e.type==q.Al){var i=e.value.split(",");return i=i.map((function(e){var t=e.split("#"),n=_()(t,2);return{enterprise_title_id:n[0],enterprise_name:n[1]}})),{conditionType:e.type,relation:e.compare,titles:i}}if(e.type==q.lt){var o=e.value.split(",");return o=o.map((function(e){var t=e.split("#"),n=_()(t,2);return{fee_type:n[0],fee_name:n[1]}})),{conditionType:e.type,relation:e.compare,feeData:o}}if(e.type==q.w7){var c=e.value.split(",");return c=c.map((function(e){return{label:n(e),value:e}})),{conditionType:e.type,relation:e.compare,travelModeData:c}}if(e.type==q.NY){var u=e.value.split(",");return u=u.map((function(e){return{label:n(e),value:e}})),{conditionType:e.type,relation:e.compare,travelTypeData:u}}if(e.type==q.l2){var s=e.value.split(",");return{conditionType:e.type,relation:e.compare,officeLocationData:s}}if(e.type==q.j4){var d=e.value&&e.value.split(","),p=_()(d,2),m=p[0],f=p[1];return{conditionType:e.type,relation:e.compare,startAmount:m?+m:null,endAmount:f?+f:null}}var v=e.value&&e.value.split(","),y=_()(v,2),b=y[0],h=y[1];return{conditionType:e.type,relation:e.compare,startAmount:b?(+b).div(100):null,endAmount:h?(+h).div(100):null}}));console.log("初始化后conditions列表",l),t.state.conditions=l}return t}return R()(r,[{key:"componentDidMount",value:function(){this.initData()}},{key:"render",value:function(){var e=this,t=this.state,n=t.titleEditable,a=t.drawerModel,r=t.lineNodesConfig,l=(t.treeData,t.memberSelectorVisible,t.departSelectorVisible,t.invoiceTitleData,t.feeTypeData,t.priority),i=t.roles,o=void 0===i?[]:i,c=(t.roleSelectorVisible,[]),u=c.filter((function(e){return"travel_type"===e.field})).map((function(e){return{label:e.label,value:e.value}}));return c.filter((function(e){return"travel_way"===e.field})).map((function(e){return{label:e.label,value:e.value}})),console.log(u),o.map((function(e){return U(U({},e),{},{key:e.role_id,title:e.role_name})})),j.createElement("div",{className:"condition-edit-drawer_contailer"},j.createElement("div",{className:"drawer-header"},j.createElement("div",{className:"left-header"},j.createElement(B.Z,{visible:!n},j.createElement("span",{className:"edit-title"},a.node_name),j.createElement("span",{className:"edit-icon",onClick:this.onTitleEdit,style:{marginLeft:10}})),j.createElement(B.Z,{visible:n},j.createElement($.Z,{maxLength:20,value:a.node_name,ref:this.inputRef,onChange:this.onTitleChange,onBlur:this.onTitleBlur,style:{width:300}}))),j.createElement(O.Z,{className:"priority",onChange:this.onPriorityChange,value:l},r.currentNodes.lineNodes.slice(0,-1).map((function(e){return j.createElement(X,{value:e.node_option,key:e.node_option},e.node_option)}))),j.createElement(J.Z,{placement:"bottomLeft"},j.createElement("span",null,"首先匹配“优先级1”的条件。如果匹配成功则审批单发送给该条件下的审批人和抄送人；如果匹配不成功则继续进行匹配下一优先级的条件。"))),j.createElement("div",{className:"drawer-content-wrapper"},j.createElement("h1",{style:{fontSize:16}},"同时满足以下条件"),this.generateConfList()),j.createElement("div",{className:"button-bar"},j.createElement(W.Z,{type:"primary",onClick:function(){e.submit()}},"确定"),j.createElement(W.Z,{onClick:this.onCloseDrawer},"取消")))}}]),r}(j.Component)},71621:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>x});var a=n(58548),r=n.n(a),l=n(78829),i=n.n(l),o=n(51765),c=n.n(o),u=n(93287),s=n.n(u),d=n(24309),p=n.n(d),m=n(33929),f=n.n(m),v=n(69984),y=n.n(v),b=n(48550),h=n.n(b),g=n(67294),_=n(75837),T=n(34041),E=n(14617),S=n(34046),w=n(80129),k=n.n(w),Z=n(45724);function C(e,t){var n=f()(e);if(p()){var a=p()(e);t&&(a=a.filter((function(t){return s()(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){y()(e,t,n[t])})):c()?i()(e,c()(n)):C(Object(n)).forEach((function(t){r()(e,t,s()(n,t))}))}return e}var A=_.Z.TreeNode,N=T.Z.Option;const x=function(e){var t=e.value,n=void 0===t?{}:t,a=e.onChange,r=e.showMemberSelector,l=e.index,i=e.showRoleSelector,o=e.showInvoiceSelector,c=e.parentFields,u=e.showFeeTypeSelector,s=e.showDepartSelector,d=e.showTravelTypeSelector,p=e.showTravelModeSelector,m=e.cityConfigList,f=e.conditionLabelMap,v=(0,g.useState)(n.relation),y=h()(v,2),b=y[0],w=y[1],C=(0,g.useState)(n.conditionType),x=h()(C,2),R=x[0],M=x[1],V=(0,g.useState)(n.startAmount),P=h()(V,2),F=P[0],L=P[1],I=(0,g.useState)(n.endAmount),j=h()(I,2),G=j[0],B=j[1],O=(0,g.useState)(n.officeLocationData),H=h()(O,2),Y=H[0],W=H[1],$=[];switch(n.conditionType){case Z.l9:case Z.Fr:case Z.Al:case Z.l2:case Z.NY:case Z.Bv:$=Z.zH;break;case Z.lt:case Z.w7:$=Z.ve;break;case Z.j4:default:$=Z.J_}var z=(0,g.useState)($),J=h()(z,2),q=J[0],K=J[1],Q=n.members,U=void 0===Q?[]:Q,X=n.roles,ee=void 0===X?[]:X,te=n.departs,ne=void 0===te?[]:te,ae=n.titles,re=void 0===ae?[]:ae,le=n.feeData,ie=void 0===le?[]:le,oe=n.travelModeData,ce=void 0===oe?[]:oe,ue=n.travelTypeData,se=void 0===ue?[]:ue,de=k().parse(window.location.search,{ignoreQueryPrefix:!0}).doc_tmpl_type,pe=Z.S_.filter((function(e){return"ALL"===e.template_types||e.template_types.includes(+de)}));(0,g.useEffect)((function(){var e;(function(e){if(null==e)return!0})(R)||(e={conditionType:R,relation:b,officeLocationData:Y,startAmount:F,endAmount:G},a&&a(D(D({conditionType:R,relation:b},n),e)))}),[R,b,Y,F,G]);var me=function(e){L(e.target.value)},fe=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=[];return t.length>0&&t.forEach((function(t){t.child?a.push(g.createElement(A,{isLeaf:!1,selectable:!1,value:"".concat(n,"|").concat(t.name),key:"".concat(t.name,"parent"),title:t.name},e(t.child,t.name))):a.push(g.createElement(A,{isLeaf:!0,value:"".concat(n,"|").concat(t.name),key:"".concat(t.name,"child"),title:t.name}))})),a}(m);return g.createElement("span",{className:"condition-edit-wrap",style:{display:"flex"}},g.createElement(T.Z,{value:n.conditionType||R,placeholder:"请选择条件",onChange:function(e){switch(M(e),e){case Z.l9:case Z.Fr:case Z.Al:case Z.l2:case Z.NY:case Z.Bv:K(Z.zH),w(Z.zH[0].value);break;case Z.lt:case Z.w7:K(Z.ve),w(Z.ve[0].value);break;case Z.j4:default:K(Z.J_),w(Z.J_[0].value)}L(null),B(null)},className:"condition-type-select"},pe.map((function(e){return g.createElement(N,{value:e.value,key:e.value,disabled:c.includes(e.value)},f[e.field]||e.label)}))),g.createElement(S.Z,{visible:void 0!==n.conditionType&&null!==n.conditionType},g.createElement(T.Z,{value:n.relation||b,className:"condition-relation-select",onChange:function(e){w(e)}},q.map((function(e){return g.createElement(N,{value:e.value,key:e.value},e.label)})))),g.createElement(S.Z,{visible:n.conditionType===Z.l9},g.createElement("div",{className:"condition-edit-mem-sel",onClick:function(){r(U,l)}},g.createElement(S.Z,{visible:U.length>0},g.createElement("div",null,U.map((function(e){return g.createElement("span",{className:"condition-edit-member-styl",key:e.id},g.createElement("span",{className:"condition-edit-item-content ".concat(e.leave?"quit":"")},"".concat(e.name).concat(e.leave?"(已离职)":"")))})))),g.createElement(S.Z,{visible:0===U.length},"添加成员+"))),g.createElement(S.Z,{visible:n.conditionType===Z.Bv},g.createElement("div",{className:"condition-edit-mem-sel",onClick:function(){i(l)}},g.createElement(S.Z,{visible:ee.length>0},g.createElement("div",null,ee.map((function(e){return g.createElement("span",{className:"condition-edit-member-styl",key:e.role_id},g.createElement("span",{className:"condition-edit-item-content ".concat(e.is_del?"quit":"")},"".concat(e.role_name).concat(e.is_del?"(已删除)":"")))})))),g.createElement(S.Z,{visible:0===ee.length},"添加+"))),g.createElement(S.Z,{visible:n.conditionType===Z.Fr},g.createElement("div",{className:"condition-edit-mem-sel",onClick:function(){s(ne,l)}},g.createElement(S.Z,{visible:ne.length>0},g.createElement("div",null,ne.map((function(e){return g.createElement("span",{className:"condition-edit-member-styl",key:e.id},e.name)})))),g.createElement(S.Z,{visible:0===ne.length},"添加部门+"))),g.createElement(S.Z,{visible:n.conditionType===Z.Al},g.createElement("div",{className:"condition-edit-mem-sel",onClick:function(){o(re,l)}},g.createElement(S.Z,{visible:re.length>0},g.createElement("div",null,re.map((function(e){return g.createElement("span",{className:"condition-edit-member-styl",key:e.enterprise_title_id},e.enterprise_name)})))),g.createElement(S.Z,{visible:0===re.length},"选择公司抬头+"))),g.createElement(S.Z,{visible:n.conditionType===Z.lt},g.createElement("div",{className:"condition-edit-mem-sel",onClick:function(){u(ie,l)}},g.createElement(S.Z,{visible:ie.length>0},g.createElement("div",null,ie.map((function(e){return g.createElement("span",{className:"condition-edit-member-styl",key:e.fee_type},e.fee_name)})))),g.createElement(S.Z,{visible:0===ie.length},"选择费用类型+"))),g.createElement(S.Z,{visible:n.conditionType===Z.w7},g.createElement("div",{className:"condition-edit-mem-sel",onClick:function(){p(ce,l)}},g.createElement(S.Z,{visible:ce.length>0},g.createElement("div",null,ce.map((function(e){return g.createElement("span",{className:"condition-edit-member-styl",key:e.value},e.label)})))),g.createElement(S.Z,{visible:0===ce.length},"选择出行方式+"))),g.createElement(S.Z,{visible:n.conditionType===Z.NY},g.createElement("div",{className:"condition-edit-mem-sel",onClick:function(){d(se,l)}},g.createElement(S.Z,{visible:se.length>0},g.createElement("div",null,se.map((function(e){return g.createElement("span",{className:"condition-edit-member-styl",key:e.value},e.label)})))),g.createElement(S.Z,{visible:0===se.length},"选择出行类型+"))),g.createElement(S.Z,{visible:n.conditionType===Z.l2},g.createElement(_.Z,{placeholder:"请选择办公地点",multiple:!0,style:{flex:1},value:Y,onChange:function(e,t,n){W(e),console.log(Y),console.log(e,t,n)}},fe)),g.createElement(S.Z,{visible:function(e){switch(e){case Z.Bc:case Z.j4:return!0;default:return!1}}(n.conditionType)},g.createElement("div",{style:{flex:1}},g.createElement(S.Z,{visible:n.relation!==Z.xG},g.createElement(E.Z,{className:"single-input",placeholder:n.conditionType===Z.j4?"出差时长（小时）":null,type:"number",value:n.startAmount||F,onChange:me})),g.createElement(S.Z,{visible:n.relation===Z.xG},g.createElement(E.Z,{className:"double-input-inline",placeholder:n.conditionType===Z.j4?"出差时长（小时）":null,type:"number",value:n.startAmount||F,onChange:me}),g.createElement("span",{className:"input-split"},"-"),g.createElement(E.Z,{className:"double-input-inline",placeholder:n.conditionType===Z.j4?"出差时长（小时）":null,type:"number",value:n.endAmount||G,onChange:function(e){B(e.target.value)}})))))}},45724:(e,t,n)=>{"use strict";n.d(t,{WD:()=>i,KT:()=>o,xV:()=>c,ux:()=>u,Oh:()=>s,PC:()=>d,k0:()=>p,dA:()=>m,Dw:()=>f,d:()=>v,EN:()=>y,MZ:()=>b,EZ:()=>h,yl:()=>g,du:()=>_,y5:()=>T,ok:()=>E,lf:()=>S,w9:()=>w,LI:()=>k,l9:()=>Z,Fr:()=>C,Al:()=>D,Bc:()=>A,lt:()=>N,w7:()=>x,NY:()=>R,l2:()=>M,j4:()=>V,Bv:()=>P,S_:()=>F,zH:()=>L,ve:()=>I,xG:()=>j,J_:()=>G});var a=n(74720),r=n.n(a),l=function(e){e=e||32;for(var t="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=t.length,a="",r=0;r<e;r++)a+=t.charAt(Math.floor(Math.random()*n));return a},i="APPLICANT_NODE",o="ROUTER_NODE",c="END",u=1,s=3,d=4,p=5,m=6,f=1,v=3,y=2,b=4,h=[f,y,b],g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,t={user_type:e};return e===y&&(t.level_num="3",t.level_type=1),{node_type:u,key:l(),node_name:"主管审批",child_nodes:[],node_option:"",node_value:r()(t)}},_=function(){return{node_type:s,key:l(),node_name:"财务审核",child_nodes:[],node_option:"",node_value:r()({user_type:1,sign_method:2})}},T=function(){return{node_type:p,key:l(),node_name:"抄送人",child_nodes:[],node_option:"",node_value:r()({})}},E=function(){return{node_type:d,key:l(),node_name:"出纳支付",child_nodes:[],node_option:"",node_value:r()({user_type:1,pay_status:1})}},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"条件1",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"优先级1",a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r="";return{node_type:m,child_nodes:e,key:l(),node_name:t,node_option:n,node_value:r,default:a}},w=[{label:"直接主管",value:"1"},{label:"第2级主管",value:"2"},{label:"第3级主管",value:"3"},{label:"第4级主管",value:"4"},{label:"第5级主管",value:"5"},{label:"第6级主管",value:"6"},{label:"第7级主管",value:"7"},{label:"第8级主管",value:"8"}],k=[{label:"最高层级主管",value:"1"},{label:"第2个层级主管",value:"2"},{label:"第3个层级主管",value:"3"},{label:"第4个层级主管",value:"4"},{label:"第5个层级主管",value:"5"},{label:"第6个层级主管",value:"6"},{label:"第7个层级主管",value:"7"},{label:"第8个层级主管",value:"8"}],Z=1,C=2,D=3,A=4,N=5,x=6,R=7,M=8,V=9,P=10,F=[{label:"申请人",value:Z,template_types:"ALL",field:"commiter"},{label:"费用部门",value:C,template_types:"ALL",field:"department"},{label:"公司抬头",value:D,template_types:"ALL",field:"title"},{label:"报销金额",value:A,template_types:[1],field:"amount"},{label:"招待金额",value:A,template_types:[2],field:"amount"},{label:"付款金额",value:A,template_types:[4]},{label:"借款金额",value:A,template_types:[3],field:"amount"},{label:"出行方式",value:x,template_types:[2],field:"trans_way"},{label:"出行类型",value:R,template_types:[2],field:"travel_type"},{label:"费用类型",value:N,template_types:[1,4]},{label:"办公地点",value:M,template_types:"ALL"},{label:"出差时长",value:V,template_types:[2]},{label:"用户组",value:P,template_types:"ALL"}],L=[{label:"属于",value:1},{label:"不属于",value:2}],I=[{label:"包含",value:9},{label:"不包含",value:10}],j=8,G=[{label:"大于",value:3},{label:"大于等于",value:4},{label:"等于",value:5},{label:"小于",value:7},{label:"小于等于",value:6},{label:"介于",value:j}]}}]);